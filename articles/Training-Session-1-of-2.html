<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PKNCA Training Session 1 of 2 • PKNCA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="PKNCA Training Session 1 of 2">
<meta property="og:description" content="PKNCA">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PKNCA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.5.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/AUC-Calculation-with-PKNCA.html">AUC Calculation with PKNCA</a>
    </li>
    <li>
      <a href="../articles/Example-theophylline.html">Computing NCA Parameters for Theophylline</a>
    </li>
    <li>
      <a href="../articles/Half-Life-Calculation.html">Half-Life Calculation</a>
    </li>
    <li>
      <a href="../articles/Introduction-and-Usage.html">Introduction to PKNCA and Usage Instructions</a>
    </li>
    <li>
      <a href="../articles/Methods-for-Dose-Aware-Interpolation-and-Extrapolation.html">Methods Used for Dose-Aware Concentration Interpolation/Extrapolation</a>
    </li>
    <li>
      <a href="../articles/Options-for-Controlling-PKNCA.html">Options for Controlling PKNCA</a>
    </li>
    <li>
      <a href="../articles/PKNCA-validation.html">PKNCA Validation</a>
    </li>
    <li>
      <a href="../articles/Post-Processing.html">Post-Processing</a>
    </li>
    <li>
      <a href="../articles/Selection-of-Calculation-Intervals.html">Selection of Calculation Intervals</a>
    </li>
    <li>
      <a href="../articles/Superposition.html">Superposition of Pharmacokinetic Data</a>
    </li>
    <li>
      <a href="../articles/Training-Session-1-of-2.html">PKNCA Training Session 1 of 2</a>
    </li>
    <li>
      <a href="../articles/Writing-Parameter-Functions.html">Writing PKNCA Parameter Functions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/billdenney/pknca/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Training-Session-1-of-2_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>PKNCA Training Session 1 of 2</h1>
                        <h4 class="author">William Denney</h4>
            
            <h4 class="date">5 November 2021</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/billdenney/pknca/blob/master/vignettes/Training-Session-1-of-2.Rmd"><code>vignettes/Training-Session-1-of-2.Rmd</code></a></small>
      <div class="hidden name"><code>Training-Session-1-of-2.Rmd</code></div>

    </div>

    
    
<style>
.forceBreak { -webkit-column-break-after: always; break-after: column; }

<!-- from https://stackoverflow.com/questions/1909648/stacking-divs-on-top-of-each-other -->
.container {
  width: 300px;
  height: 300px;
  margin: 0 auto;
  background-color: yellow;
  /* important part */
  display: grid;
  place-items: center;
  grid-template-areas: "inner-div";
}

.inner {
  /* important part */
  grid-area: inner-div;
}

.bigStrikethroughOuter {
  <!-- text-decoration: line-through; -->
  font-size: 8em;
  text-align: center;
  color: red;
  background: 
  linear-gradient(to top left,
    transparent 0%,
    transparent calc(50% - 0.05em),
    red calc(50% - 0.05em),
    red 50%,
    red calc(50% + 0.05em),
    transparent calc(50% + 0.05em),
    transparent 100%),
  linear-gradient(to top right,
    transparent 0%,
    transparent calc(50% - 0.05em),
    red calc(50% - 0.05em),
    red 50%,
    red calc(50% + 0.05em),
    transparent calc(50% + 0.05em),
    transparent 100%);
}

.bigStrikethroughInner {
  color: blue;
  font-size: 8em;
}

.autoImageWidth {
  width: auto !important; /*override the width below*/
  max-width: 100%;
  float: left;
  clear: both;
  text-align: center;
}

</style>
<div id="introduction-to-pknca-and-basics-of-its-use" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction-to-pknca-and-basics-of-its-use" class="anchor"></a>Introduction to PKNCA and Basics of Its Use</h1>
<div id="introduction-to-pknca" class="section level2 build smaller">
<h2 class="hasAnchor">
<a href="#introduction-to-pknca" class="anchor"></a>Introduction to PKNCA</h2>
<p>PKNCA is a tool for calculating noncompartmental analysis (NCA) results for pharmacokinetic (PK) data.</p>
<p>… but, you already knew that or you wouldn’t be here.</p>
<p>PKNCA has several foci:</p>
<ul>
<li>be regulatory-ready
<ul>
<li>it has approximately 100% test coverage.</li>
</ul>
</li>
<li>be reproducible
<ul>
<li>it has a focus on being scriptable.</li>
</ul>
</li>
<li>get the right answer or none at all
<ul>
<li>it will try to know what you want,</li>
<li>but all decisions can be overridden, and</li>
<li>if there is a question that may cause an error or an unanticipated result, either no result will output or an error will be raised.</li>
</ul>
</li>
</ul>
</div>
<div id="enjoy" class="section level2 build">
<h2 class="hasAnchor">
<a href="#enjoy" class="anchor"></a>Enjoy!</h2>
<p>I hope that you have a whale of a good time during this training.</p>
<p><img src="https://apps-afsc.fisheries.noaa.gov/Quarterly/amj2005/images/killerwhales.jpg"></p>
<p>(Foreshadowing…)</p>
</div>
<div id="some-nca-definitions" class="section level2">
<h2 class="hasAnchor">
<a href="#some-nca-definitions" class="anchor"></a>Some NCA Definitions</h2>
<ul>
<li>
<strong>C<sub>max</sub></strong>: The maximum observed concentration</li>
<li>
<strong>T<sub>max</sub></strong>: The time of the maximum observed concentration</li>
<li>
<strong>t<sub>last</sub></strong>: The time of the last concentration above the limit of quantification</li>
<li>
<strong>AUC</strong>: Area under the concentration-time curve. Some important AUC variants are:
<ul>
<li>
<strong>AUC<sub>last</sub></strong>: AUC from time zero to t<sub>last</sub>
</li>
<li>
<strong>AUC<sub>int</sub></strong>: AUC from time zero to the end of an interval of time, often extrapolated or interpolated (e.g. AUC<sub>0-24hr</sub>)</li>
<li>
<strong>AUC<sub>∞</sub></strong>: AUC from time zero to t<sub>last</sub> then extrapolated from t<sub>last</sub> to time infinity using the half life</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="dataset-basics" class="section level1">
<h1 class="hasAnchor">
<a href="#dataset-basics" class="anchor"></a>Dataset Basics</h1>
<div id="nca-data-are-not-tidy-as-a-single-dataset" class="section level2">
<h2 class="hasAnchor">
<a href="#nca-data-are-not-tidy-as-a-single-dataset" class="anchor"></a>NCA Data are Not Tidy <strong><em>as a Single Dataset</em></strong>
</h2>
<p>“Tidy datasets… have a specific structure: each variable is a column, each observation is a row, and each type of observational unit is a table.” - Hadley Wickham (<a href="https://doi.org/10.18637/jss.v059.i10" class="uri">https://doi.org/10.18637/jss.v059.i10</a>)</p>
<p>CDISC has NCA tidied, and PKNCA follows that model:</p>
<ul>
<li>concentration-time is a dataset (PC domain; <code><a href="../reference/PKNCAconc.html">PKNCAconc()</a></code> object)</li>
<li>dose-time is a dataset (EX/EC domains; <code><a href="../reference/PKNCAdose.html">PKNCAdose()</a></code> object)</li>
<li>NCA results are a dataset (PP domain; <code><a href="../reference/pk.nca.html">pk.nca()</a></code> output)</li>
</ul>
</div>
<div id="dataset-basics-minimum-data" class="section level2">
<h2 class="hasAnchor">
<a href="#dataset-basics-minimum-data" class="anchor"></a>Dataset Basics: Minimum data</h2>
<p>PKNCA requires at minimum concentration, time, and what you want to calculate.</p>
<p><img src="Training-Session-1-of-2_files/figure-html/unnamed-chunk-1-1.png" width="576"></p>
</div>
<div id="dataset-basics-what-columns-are-needed" class="section level2">
<h2 class="hasAnchor">
<a href="#dataset-basics-what-columns-are-needed" class="anchor"></a>Dataset Basics: What columns are needed?</h2>
<p>Column names are provided by the input to <code><a href="../reference/PKNCAconc.html">PKNCAconc()</a></code> and <code><a href="../reference/PKNCAdose.html">PKNCAdose()</a></code>; they are not hard-coded.</p>
<p>Columns that can be used include:</p>
<ul>
<li>
<code><a href="../reference/PKNCAconc.html">PKNCAconc()</a></code>: concentration, time, groups; data exclusions; half-life inclusion and exclusion</li>
<li>
<code><a href="../reference/PKNCAdose.html">PKNCAdose()</a></code>: dose, time, groups; route, rate/duration of infusion; data exclusions</li>
<li>intervals given to <code><a href="../reference/PKNCAdata.html">PKNCAdata()</a></code>: groups, start, end, and any NCA parameters to calculate</li>
</ul>
</div>
<div id="dataset-basics-example-data" class="section level2">
<h2 class="hasAnchor">
<a href="#dataset-basics-example-data" class="anchor"></a>Dataset Basics: Example data</h2>
<p>In the following slides, abbreviated data from an example study where two treatments (“A” and “B”) are administered to two subjects (1 and 2).</p>
<ul>
<li>For PKNCA, the groups will be <strong>Treatment</strong> and <strong>Subject</strong>.
<ul>
<li>PKNCA considers groups in order with the subject identifier as the last group (or the last group before a forward slash, <code>/</code>, if <code>/</code> is present).</li>
<li>When indicated in order (<code>...|Treatment+Subject</code>), PKNCA automatically knows to keep <strong>Treatment</strong> and drop <strong>Subject</strong> for summaries (more on that later).</li>
</ul>
</li>
</ul>
</div>
<div id="dataset-basics-example-concentration-data" class="section level2 columns-2">
<h2 class="hasAnchor">
<a href="#dataset-basics-example-concentration-data" class="anchor"></a>Dataset Basics: Example concentration data</h2>
<table class="table">
<colgroup>
<col width="13%">
<col width="16%">
<col width="9%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="center">Subject</th>
<th align="center">Treatment</th>
<th align="center">Time</th>
<th align="center">Conc</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">A</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">A</td>
<td align="center">2</td>
<td align="center">2.143</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">A</td>
<td align="center">8</td>
<td align="center">0.4696</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">B</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">B</td>
<td align="center">2</td>
<td align="center">2.179</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">B</td>
<td align="center">8</td>
<td align="center">0.4852</td>
</tr>
</tbody>
</table>
<p class="forceBreak">
</p>
<table class="table">
<colgroup>
<col width="13%">
<col width="16%">
<col width="9%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="center">Subject</th>
<th align="center">Treatment</th>
<th align="center">Time</th>
<th align="center">Conc</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">2</td>
<td align="center">A</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">A</td>
<td align="center">2</td>
<td align="center">1.937</td>
</tr>
<tr class="odd">
<td align="center">2</td>
<td align="center">A</td>
<td align="center">8</td>
<td align="center">0.4929</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">B</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">2</td>
<td align="center">B</td>
<td align="center">2</td>
<td align="center">2.127</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">B</td>
<td align="center">8</td>
<td align="center">0.4804</td>
</tr>
</tbody>
</table>
</div>
<div id="dataset-basics-example-dosing-data" class="section level2">
<h2 class="hasAnchor">
<a href="#dataset-basics-example-dosing-data" class="anchor"></a>Dataset Basics: Example dosing data</h2>
<table class="table">
<colgroup>
<col width="13%">
<col width="16%">
<col width="9%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th align="center">Subject</th>
<th align="center">Treatment</th>
<th align="center">Time</th>
<th align="center">Dose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">A</td>
<td align="center">0</td>
<td align="center">10</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">B</td>
<td align="center">0</td>
<td align="center">10</td>
</tr>
</tbody>
</table>
<p class="forceBreak">
</p>
<table class="table">
<colgroup>
<col width="13%">
<col width="16%">
<col width="9%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th align="center">Subject</th>
<th align="center">Treatment</th>
<th align="center">Time</th>
<th align="center">Dose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">2</td>
<td align="center">A</td>
<td align="center">0</td>
<td align="center">10</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">B</td>
<td align="center">0</td>
<td align="center">10</td>
</tr>
</tbody>
</table>
</div>
<div id="dataset-basics-example-interval-data" class="section level2">
<h2 class="hasAnchor">
<a href="#dataset-basics-example-interval-data" class="anchor"></a>Dataset Basics: Example interval data</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d_interval_1</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    start<span class="op">=</span><span class="fl">0</span>, end<span class="op">=</span><span class="fl">8</span>,
    cmax<span class="op">=</span><span class="cn">TRUE</span>, tmax<span class="op">=</span><span class="cn">TRUE</span>, auclast<span class="op">=</span><span class="cn">TRUE</span>
  <span class="op">)</span></code></pre></div>
<table class="table">
<colgroup>
<col width="11%">
<col width="8%">
<col width="9%">
<col width="9%">
<col width="13%">
</colgroup>
<thead><tr class="header">
<th align="center">start</th>
<th align="center">end</th>
<th align="center">cmax</th>
<th align="center">tmax</th>
<th align="center">auclast</th>
</tr></thead>
<tbody><tr class="odd">
<td align="center">0</td>
<td align="center">8</td>
<td align="center">TRUE</td>
<td align="center">TRUE</td>
<td align="center">TRUE</td>
</tr></tbody>
</table>
<p>Groups are not required, if you want the same intervals calculated for each group.</p>
</div>
<div id="hands-on-first-nca-calculation-with-pknca" class="section level2">
<h2 class="hasAnchor">
<a href="#hands-on-first-nca-calculation-with-pknca" class="anchor"></a>Hands-on: First NCA calculation with PKNCA</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://billdenney.github.io/pknca/">PKNCA</a></span><span class="op">)</span>
<span class="co"># Concentration data setup</span>
<span class="va">d_conc</span> <span class="op">&lt;-</span>
  <span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html">Theoph</a></span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Subject</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fl">1</span><span class="op">)</span>
<span class="va">o_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span><span class="va">conc</span><span class="op">~</span><span class="va">Time</span>, data<span class="op">=</span><span class="va">d_conc</span><span class="op">)</span>
<span class="co"># Setup intervals for calculation</span>
<span class="va">d_intervals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>start<span class="op">=</span><span class="fl">0</span>, end<span class="op">=</span><span class="fl">24</span>, cmax<span class="op">=</span><span class="cn">TRUE</span>, tmax<span class="op">=</span><span class="cn">TRUE</span>, auclast<span class="op">=</span><span class="cn">TRUE</span>, aucint.inf.obs<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="co"># Combine concentration and dose</span>
<span class="va">o_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdata.html">PKNCAdata</a></span><span class="op">(</span><span class="va">o_conc</span>, intervals<span class="op">=</span><span class="va">d_intervals</span><span class="op">)</span>
<span class="co"># Calculate the results (suppressMessages() hides a message that isn't needed now)</span>
<span class="va">o_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span><span class="op">(</span><span class="fu"><a href="../reference/pk.nca.html">pk.nca</a></span><span class="op">(</span><span class="va">o_data</span><span class="op">)</span><span class="op">)</span>
<span class="co"># summary(o_result)</span></code></pre></div>
</div>
</div>
<div id="pknca-functions" class="section level1">
<h1 class="hasAnchor">
<a href="#pknca-functions" class="anchor"></a>PKNCA Functions</h1>
<div id="what-functions-are-the-most-used" class="section level2">
<h2 class="hasAnchor">
<a href="#what-functions-are-the-most-used" class="anchor"></a>What functions are the most used?</h2>
<ul>
<li>
<code><a href="../reference/PKNCAconc.html">PKNCAconc()</a></code>: define a concentration-time <code>PKNCAconc</code> object
<ul>
<li>All information about concentration data are given: concentration, time</li>
<li>Optional information includes: grouping information (usually given), data to exclude, half-life inclusion and exclusion columns</li>
</ul>
</li>
<li>
<code><a href="../reference/PKNCAdose.html">PKNCAdose()</a></code>: define a dose-time <code>PKNCAdose</code> object (optional)
<ul>
<li>dose amount and time are both optional</li>
<li>Optional information includes: rate or duration of infusion, data to exclude</li>
</ul>
</li>
<li>
<code><a href="../reference/PKNCAdata.html">PKNCAdata()</a></code>: combine <code>PKNCAconc</code>, optionally <code>PKNCAdose</code>, and optionally <code>intervals</code> into a <code>PKNCAdata</code> object
<ul>
<li>the <code>PKNCAconc</code> object must be given; the <code>PKNCAdose</code> object is optional; interval definitions are usually given; calculation options may be given</li>
</ul>
</li>
<li>
<code><a href="../reference/pk.nca.html">pk.nca()</a></code>: calculate the NCA parameters from a data object into a <code>PKNCAresult</code> object</li>
</ul>
</div>
<div id="how-do-i-do-a-simple-calculation-all-steps" class="section level2">
<h2 class="hasAnchor">
<a href="#how-do-i-do-a-simple-calculation-all-steps" class="anchor"></a>How do I do a simple calculation? all steps</h2>
<p>We will break this down in subsequent slides.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Concentration data setup</span>
<span class="va">d_conc</span> <span class="op">&lt;-</span>
  <span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html">Theoph</a></span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Subject</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fl">1</span><span class="op">)</span>
<span class="va">o_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span><span class="va">conc</span><span class="op">~</span><span class="va">Time</span>, data<span class="op">=</span><span class="va">d_conc</span><span class="op">)</span>
<span class="co"># Dose data setup</span>
<span class="va">d_dose</span> <span class="op">&lt;-</span>
  <span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html">Theoph</a></span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Subject</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Time</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">o_dose</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdose.html">PKNCAdose</a></span><span class="op">(</span><span class="va">Dose</span><span class="op">~</span><span class="va">Time</span>, data<span class="op">=</span><span class="va">d_dose</span><span class="op">)</span>
<span class="co"># Combine concentration and dose</span>
<span class="va">o_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdata.html">PKNCAdata</a></span><span class="op">(</span><span class="va">o_conc</span>, <span class="va">o_dose</span><span class="op">)</span>
<span class="co"># Calculate the results</span>
<span class="va">o_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pk.nca.html">pk.nca</a></span><span class="op">(</span><span class="va">o_data</span><span class="op">)</span></code></pre></div>
</div>
<div id="how-do-i-do-a-simple-calculation-concentration-data" class="section level2 smaller">
<h2 class="hasAnchor">
<a href="#how-do-i-do-a-simple-calculation-concentration-data" class="anchor"></a>How do I do a simple calculation? Concentration data</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load your dataset as a data.frame</span>
<span class="va">d_conc</span> <span class="op">&lt;-</span>
  <span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html">Theoph</a></span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Subject</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fl">1</span><span class="op">)</span>
<span class="co"># Take a look at the data</span>
<span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">d_conc</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table">
<colgroup>
<col width="13%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th align="center">Subject</th>
<th align="center">Wt</th>
<th align="center">Dose</th>
<th align="center">Time</th>
<th align="center">conc</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">79.6</td>
<td align="center">4.02</td>
<td align="center">0</td>
<td align="center">0.74</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">79.6</td>
<td align="center">4.02</td>
<td align="center">0.25</td>
<td align="center">2.84</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Define the PKNCAconc object indicating the concentration and time columns, the</span>
<span class="co"># dataset, and any other options.</span>
<span class="va">o_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span><span class="va">conc</span><span class="op">~</span><span class="va">Time</span>, data<span class="op">=</span><span class="va">d_conc</span><span class="op">)</span></code></pre></div>
</div>
<div id="how-do-i-do-a-simple-calculation-dose-data" class="section level2 smaller">
<h2 class="hasAnchor">
<a href="#how-do-i-do-a-simple-calculation-dose-data" class="anchor"></a>How do I do a simple calculation? Dose data</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load your dataset as a data.frame</span>
<span class="va">d_dose</span> <span class="op">&lt;-</span>
  <span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html">Theoph</a></span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Subject</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Time</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>
<span class="co"># Take a look at the data</span>
<span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span><span class="va">d_dose</span><span class="op">)</span></code></pre></div>
<table class="table">
<colgroup>
<col width="13%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th align="center">Subject</th>
<th align="center">Wt</th>
<th align="center">Dose</th>
<th align="center">Time</th>
<th align="center">conc</th>
</tr></thead>
<tbody><tr class="odd">
<td align="center">1</td>
<td align="center">79.6</td>
<td align="center">4.02</td>
<td align="center">0</td>
<td align="center">0.74</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Define the PKNCAdose object indicating the dose amount and time columns, the</span>
<span class="co"># dataset, and any other options.</span>
<span class="va">o_dose</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdose.html">PKNCAdose</a></span><span class="op">(</span><span class="va">Dose</span><span class="op">~</span><span class="va">Time</span>, data<span class="op">=</span><span class="va">d_dose</span><span class="op">)</span></code></pre></div>
</div>
<div id="how-do-i-do-a-simple-calculation-calculate-results" class="section level2 smaller">
<h2 class="hasAnchor">
<a href="#how-do-i-do-a-simple-calculation-calculate-results" class="anchor"></a>How do I do a simple calculation? Calculate results</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Combine the PKNCAconc and PKNCAdose objects.  You can add interval</span>
<span class="co"># specifications and calculation options here.</span>
<span class="va">o_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdata.html">PKNCAdata</a></span><span class="op">(</span><span class="va">o_conc</span>, <span class="va">o_dose</span><span class="op">)</span>
<span class="co"># Calculate the results</span>
<span class="va">o_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pk.nca.html">pk.nca</a></span><span class="op">(</span><span class="va">o_data</span><span class="op">)</span></code></pre></div>
</div>
<div id="how-do-i-do-a-simple-calculation-get-results" class="section level2">
<h2 class="hasAnchor">
<a href="#how-do-i-do-a-simple-calculation-get-results" class="anchor"></a>How do I do a simple calculation? Get results</h2>
<p>To calculate summary statistics, use <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>; to extract all individual-level results, use <code><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame()</a></code>.</p>
<p>The <code>"caption"</code> attribute of the summary describes how the summary statistics were calculated for each parameter. (Hint: <code><a href="https://rdrr.io/pkg/pander/man/pander.html">pander::pander()</a></code> knows how to use that to put the caption on a table in a report.)</p>
<p>The individual results contain the columns for start time, end time, grouping variables (none in this example), parameter names, values, and if the value should be excluded.</p>
</div>
<div id="how-do-i-do-a-simple-calculation-get-summary-results" class="section level2 smaller">
<h2 class="hasAnchor">
<a href="#how-do-i-do-a-simple-calculation-get-summary-results" class="anchor"></a>How do I do a simple calculation? Get summary results</h2>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Look at summarized results</span>
<span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">o_result</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>auclast, cmax, aucinf.obs: geometric mean and geometric coefficient of variation; tmax: median and range; half.life: arithmetic mean and standard deviation</caption>
<colgroup>
<col width="9%">
<col width="6%">
<col width="4%">
<col width="13%">
<col width="13%">
<col width="22%">
<col width="13%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th align="center">start</th>
<th align="center">end</th>
<th align="center">N</th>
<th align="center">auclast</th>
<th align="center">cmax</th>
<th align="center">tmax</th>
<th align="center">half.life</th>
<th align="center">aucinf.obs</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="center">24</td>
<td align="center">1</td>
<td align="center">92.4 [NC]</td>
<td align="center">.</td>
<td align="center">.</td>
<td align="center">.</td>
<td align="center">.</td>
</tr>
<tr class="even">
<td align="center">0</td>
<td align="center">Inf</td>
<td align="center">1</td>
<td align="center">.</td>
<td align="center">10.5 [NC]</td>
<td align="center">1.12 [1.12, 1.12]</td>
<td align="center">14.3 [NC]</td>
<td align="center">215 [NC]</td>
</tr>
</tbody>
</table>
</div>
<div id="how-do-i-do-a-simple-calculation-get-individual-results" class="section level2 smaller">
<h2 class="hasAnchor">
<a href="#how-do-i-do-a-simple-calculation-get-individual-results" class="anchor"></a>How do I do a simple calculation? Get individual results</h2>
<table class="table">
<colgroup>
<col width="11%">
<col width="8%">
<col width="15%">
<col width="13%">
<col width="13%">
</colgroup>
<thead><tr class="header">
<th align="center">start</th>
<th align="center">end</th>
<th align="center">PPTESTCD</th>
<th align="center">PPORRES</th>
<th align="center">exclude</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="center">24</td>
<td align="center">auclast</td>
<td align="center">92.37</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center">0</td>
<td align="center">Inf</td>
<td align="center">cmax</td>
<td align="center">10.5</td>
<td align="center">NA</td>
</tr>
<tr class="odd">
<td align="center">0</td>
<td align="center">Inf</td>
<td align="center">tmax</td>
<td align="center">1.12</td>
<td align="center">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="pknca-datasets" class="section level1">
<h1 class="hasAnchor">
<a href="#pknca-datasets" class="anchor"></a>PKNCA datasets</h1>
<div id="how-does-pknca-think-about-data" class="section level2">
<h2 class="hasAnchor">
<a href="#how-does-pknca-think-about-data" class="anchor"></a>How does PKNCA think about data?</h2>
<p>Three types of data are inputs for calculation in PKNCA:</p>
<ul>
<li>concentration-time (<code>PKNCAconc</code>),</li>
<li>dose-time (<code>PKNCAdose</code>), and</li>
<li>intervals.</li>
</ul>
<p><code>PKNCAconc</code> and <code>PKNCAdose</code> objects can optionally have groups. The groups in a <code>PKNCAdose</code> object must be the same or fewer than the groups in <code>PKNCAconc</code> object (for example, all subjects in a treatment arm may receive the same dose).</p>
</div>
<div id="what-is-an-interval-and-how-is-it-different-than-a-group" class="section level2 columns-2 smaller">
<h2 class="hasAnchor">
<a href="#what-is-an-interval-and-how-is-it-different-than-a-group" class="anchor"></a>What is an “interval” and how is it different than a “group”?</h2>
<p>A <strong>group</strong> separates one full concentration-time profile for a subject that you may ever want to consider at the same time. Usually, it groups by study, treatment, analyte, and subject (other groups can be useful depending on the study design).</p>
<p>An <strong>interval</strong> selects a time range within a <strong>group</strong>.</p>
<p>One time can be in zero or more intervals, but only zero or one group. Intervals can be adjacent (0-12 and 12-24) or overlap (0-12 and 0-24). In other words, one sample may be used in more than one interval, but one sample will never be used in more than one group.</p>
<p><strong>Legend:</strong> The group contains all points on the figure. Shaded regions indicate intervals. Arrows indicate points shared between intervals within the group.</p>
<p class="forceBreak">
</p>
<p><img src="Training-Session-1-of-2_files/figure-html/unnamed-chunk-17-1.png" width="384"></p>
</div>
<div id="common-data-management-requirements-before-sending-data-to-pknca" class="section level2 smaller">
<h2 class="hasAnchor">
<a href="#common-data-management-requirements-before-sending-data-to-pknca" class="anchor"></a>Common data management requirements before sending data to PKNCA</h2>
<ol style="list-style-type: decimal">
<li>Time must not be missing for <code>PKNCAconc</code> (if given to <code>PKNCAdose</code>, it must not be missing).</li>
<li>Below the limit of quantification (BLQ) concentrations must be set to zero (not <code>NA</code>).</li>
<li>Imputation of time zero is required for AUC calculation.</li>
<li>Especially for actual-time calculations, imputation of the beginning of the interval is usually needed.</li>
</ol>
<p>Columns must be created for:</p>
<ul>
<li>Concentration or dose,</li>
<li>Time</li>
<li>Groups
<ul>
<li>usually columns for study, treatment arm, subject;</li>
<li>sometimes analyte, formulation, period (needed in case the same subject receives the same treatment arm multiple times)</li>
</ul>
</li>
</ul>
</div>
<div id="setup-your-concentration-data" class="section level2 columns-2">
<h2 class="hasAnchor">
<a href="#setup-your-concentration-data" class="anchor"></a>Setup your concentration data</h2>
<ul>
<li>Concentration data must be numeric</li>
</ul>
<p class="forceBreak">
</p>
<div class="bigStrikethroughOuter">
<div class="bigStrikethroughInner">
A
</div>
</div>
</div>
<div id="setup-your-concentration-data-1" class="section level2 columns-2">
<h2 class="hasAnchor">
<a href="#setup-your-concentration-data-1" class="anchor"></a>Setup your concentration data</h2>
<ul>
<li>Concentration data must be numeric</li>
<li>Time must be numeric and not be missing</li>
</ul>
<p class="forceBreak">
</p>
<div class="bigStrikethroughOuter">
<div class="bigStrikethroughInner">
NA
</div>
</div>
</div>
<div id="setup-your-concentration-data-2" class="section level2 columns-2">
<h2 class="hasAnchor">
<a href="#setup-your-concentration-data-2" class="anchor"></a>Setup your concentration data</h2>
<ul>
<li>Concentration data must be numeric</li>
<li>Time must be numeric and not be missing</li>
<li>Groups can be anything, setup at the level of the individual</li>
</ul>
<p class="forceBreak">
</p>
<div class="autoImageWidth">
<p><img src="https://apps-afsc.fisheries.noaa.gov/Quarterly/amj2005/images/killerwhales.jpg"><br> Group: <span style="color: green;">🗸</span> a pod of killer whales</p>
</div>
</div>
<div id="setup-your-dosing-data-if-you-have-it-and-even-if-you-dont" class="section level2 smaller">
<h2 class="hasAnchor">
<a href="#setup-your-dosing-data-if-you-have-it-and-even-if-you-dont" class="anchor"></a>Setup your dosing data (if you have it and even if you don’t)</h2>
<p>Normal dosing data setup: <code>PKNCAdose(dose~time|actarm+usubjid, data=d_dose)</code></p>
<ul>
<li>Dose amount must be numeric — or it can be omitted
<ul>
<li><code>PKNCAdose(~time|actarm+usubjid, data=d_dose)</code></li>
</ul>
</li>
<li>Time must be numeric and not be missing — or it can be omitted
<ul>
<li><code>PKNCAdose(dose~.|actarm+usubjid, data=d_dose)</code></li>
</ul>
</li>
<li>Groups can be anything — may be grouped at a higher level than the individual
<ul>
<li>Useful when all dose amounts and times are the same within an arm: <code>PKNCAdose(dose~time|actarm, data=d_dose)</code>
</li>
<li>Useful dose amount is the same at all times within an arm: <code>PKNCAdose(dose~.|actarm, data=d_dose)</code>
</li>
<li>Useful when times are all the same within an arm but dose may differ: <code>PKNCAdose(~time|actarm, data=d_dose)</code>
</li>
</ul>
</li>
</ul>
</div>
<div id="define-your-intervals" class="section level2">
<h2 class="hasAnchor">
<a href="#define-your-intervals" class="anchor"></a>Define your intervals</h2>
<p>Intervals have columns for:</p>
<ul>
<li>
<code>start</code> and <code>end</code> times for the interval,</li>
<li>groups matching any level of grouping; intervals apply by a merge/join with the groups</li>
<li>parameters to calculate (<code>TRUE</code> means to calculate it; <code>FALSE</code> means don’t). The full list of available parameters is in the <a href="http://billdenney.github.io/pknca/articles/Selection-of-Calculation-Intervals.html#parameters-available-for-calculation-in-an-interval-1">selection of calculation intervals vignette</a>.
<ul>
<li>You only have to specify the parameter you want, not all parameters.</li>
</ul>
</li>
</ul>
</div>
<div id="define-your-intervals-example" class="section level2">
<h2 class="hasAnchor">
<a href="#define-your-intervals-example" class="anchor"></a>Define your intervals: example</h2>
<ul>
<li>For time 0 to 24, calculate AUClast</li>
<li>For time 0 to infinity, calculate cmax, tmax, half.life, and aucinf.obs</li>
</ul>
<table class="table">
<colgroup>
<col width="11%">
<col width="8%">
<col width="13%">
<col width="11%">
<col width="11%">
<col width="16%">
<col width="18%">
</colgroup>
<thead><tr class="header">
<th align="center">start</th>
<th align="center">end</th>
<th align="center">auclast</th>
<th align="center">cmax</th>
<th align="center">tmax</th>
<th align="center">half.life</th>
<th align="center">aucinf.obs</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="center">24</td>
<td align="center">TRUE</td>
<td align="center">FALSE</td>
<td align="center">FALSE</td>
<td align="center">FALSE</td>
<td align="center">FALSE</td>
</tr>
<tr class="even">
<td align="center">0</td>
<td align="center">Inf</td>
<td align="center">FALSE</td>
<td align="center">TRUE</td>
<td align="center">TRUE</td>
<td align="center">TRUE</td>
<td align="center">TRUE</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="calculations-above-the-hood" class="section level1">
<h1 class="hasAnchor">
<a href="#calculations-above-the-hood" class="anchor"></a>Calculations above the hood</h1>
<div id="prepare-your-data-for-calculation" class="section level2">
<h2 class="hasAnchor">
<a href="#prepare-your-data-for-calculation" class="anchor"></a>Prepare your data for calculation</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d_conc</span> <span class="op">&lt;-</span>
  <span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html">Theoph</a></span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    Treatment<span class="op">=</span>
      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span>
        <span class="va">Dose</span> <span class="op">&lt;=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">Dose</span><span class="op">)</span><span class="op">~</span><span class="st">"Low dose"</span>,
        <span class="cn">TRUE</span><span class="op">~</span><span class="st">"High dose"</span>
      <span class="op">)</span>
  <span class="op">)</span>
<span class="co"># The study was single-dose</span>
<span class="va">d_dose</span> <span class="op">&lt;-</span>
  <span class="va">d_conc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Treatment</span>, <span class="va">Subject</span>, <span class="va">Dose</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>dose_time<span class="op">=</span><span class="fl">0</span><span class="op">)</span></code></pre></div>
</div>
<div id="calculate-without-dosing-data" class="section level2 build">
<h2 class="hasAnchor">
<a href="#calculate-without-dosing-data" class="anchor"></a>Calculate without dosing data</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">o_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span><span class="va">conc</span><span class="op">~</span><span class="va">Time</span><span class="op">|</span><span class="va">Treatment</span><span class="op">+</span><span class="va">Subject</span>, data<span class="op">=</span><span class="va">d_conc</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/try.html">try</a></span><span class="op">(</span><span class="op">{</span>
  <span class="va">o_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdata.html">PKNCAdata</a></span><span class="op">(</span><span class="va">o_conc</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/pk.nca.html">pk.nca</a></span><span class="op">(</span><span class="va">o_data</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in PKNCAdata.default(data.conc = data.conc, data.dose = data.dose,  : 
##   If data.dose is not given, intervals must be given</code></pre>
<p>Whoops! Without dosing, we need intervals.</p>
</div>
<div id="calculate-without-dosing-data-try-2" class="section level2">
<h2 class="hasAnchor">
<a href="#calculate-without-dosing-data-try-2" class="anchor"></a>Calculate without dosing data, try 2</h2>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">o_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span><span class="va">conc</span><span class="op">~</span><span class="va">Time</span><span class="op">|</span><span class="va">Treatment</span><span class="op">+</span><span class="va">Subject</span>, data<span class="op">=</span><span class="va">d_conc</span><span class="op">)</span>
<span class="va">d_intervals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>start<span class="op">=</span><span class="fl">0</span>, end<span class="op">=</span><span class="cn">Inf</span>, cmax<span class="op">=</span><span class="cn">TRUE</span>, tmax<span class="op">=</span><span class="cn">TRUE</span>, half.life<span class="op">=</span><span class="cn">TRUE</span>, aucinf.obs<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="va">o_data_manual_intervals</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdata.html">PKNCAdata</a></span><span class="op">(</span><span class="va">o_conc</span>, intervals<span class="op">=</span><span class="va">d_intervals</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/pk.nca.html">pk.nca</a></span><span class="op">(</span><span class="va">o_data_manual_intervals</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## No dose information provided, calculations requiring dose will return NA.</code></pre>
<pre><code>##  start end Treatment N        cmax               tmax   half.life aucinf.obs
##      0 Inf High dose 5 9.16 [19.4] 3.48 [0.980, 3.55] 7.73 [1.08] 120 [26.2]
##      0 Inf  Low dose 7 8.30 [15.2] 1.12 [0.630, 2.02] 8.50 [2.67] 111 [31.6]
## 
## Caption: cmax, aucinf.obs: geometric mean and geometric coefficient of variation; tmax: median and range; half.life: arithmetic mean and standard deviation</code></pre>
</div>
<div id="dosing-data-helps-with-interval-setup" class="section level2">
<h2 class="hasAnchor">
<a href="#dosing-data-helps-with-interval-setup" class="anchor"></a>Dosing data helps with interval setup</h2>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">o_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span><span class="va">conc</span><span class="op">~</span><span class="va">Time</span><span class="op">|</span><span class="va">Treatment</span><span class="op">+</span><span class="va">Subject</span>, data<span class="op">=</span><span class="va">d_conc</span><span class="op">)</span>
<span class="va">o_dose</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdose.html">PKNCAdose</a></span><span class="op">(</span><span class="va">Dose</span><span class="op">~</span><span class="va">dose_time</span><span class="op">|</span><span class="va">Treatment</span><span class="op">+</span><span class="va">Subject</span>, data<span class="op">=</span><span class="va">d_dose</span><span class="op">)</span>
<span class="va">o_data_auto_intervals</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdata.html">PKNCAdata</a></span><span class="op">(</span><span class="va">o_conc</span>, <span class="va">o_dose</span><span class="op">)</span>
<span class="va">o_data_auto_intervals</span><span class="op">$</span><span class="va">intervals</span><span class="op">$</span><span class="va">aucint.inf.obs</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/pk.nca.html">pk.nca</a></span><span class="op">(</span><span class="va">o_data_auto_intervals</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##  start end Treatment N     auclast        cmax               tmax   half.life
##      0  24  Low dose 7 70.2 [14.4]           .                  .           .
##      0 Inf  Low dose 7           . 8.30 [15.2] 1.12 [0.630, 2.02] 8.50 [2.67]
##      0  24 High dose 5 81.3 [34.2]           .                  .           .
##      0 Inf High dose 5           . 9.16 [19.4] 3.48 [0.980, 3.55] 7.73 [1.08]
##  aucinf.obs aucint.inf.obs
##           .    94.1 [22.5]
##  111 [31.6]     111 [31.6]
##           .     105 [23.3]
##  120 [26.2]     120 [26.2]
## 
## Caption: auclast, cmax, aucinf.obs, aucint.inf.obs: geometric mean and geometric coefficient of variation; tmax: median and range; half.life: arithmetic mean and standard deviation</code></pre>
</div>
<div id="auc-considerations-with-pknca-13" class="section level2 columns-2">
<h2 class="hasAnchor">
<a href="#auc-considerations-with-pknca-13" class="anchor"></a>AUC considerations with PKNCA (1/3)</h2>
<p><img src="Training-Session-1-of-2_files/figure-html/unnamed-chunk-23-1.png" width="100%"></p>
<p class="forceBreak">
</p>
<p>The considerations below mainly apply to actual-time data; nominal-time data usually have measurements at the start and end time for the interval.</p>
<p>With an interval start and end of 0 and 24 (and the last measurement time just after 24 hours):</p>
<ul>
<li>
<strong>AUC<sub>last</sub></strong> is calculated only based on points within the interval (the AUClast color in the figure)</li>
</ul>
</div>
<div id="auc-considerations-with-pknca-23" class="section level2 columns-2">
<h2 class="hasAnchor">
<a href="#auc-considerations-with-pknca-23" class="anchor"></a>AUC considerations with PKNCA (2/3)</h2>
<p><img src="Training-Session-1-of-2_files/figure-html/unnamed-chunk-24-1.png" width="100%"></p>
<p class="forceBreak">
</p>
<p>The considerations below mainly apply to actual-time data; nominal-time data usually have measurements at the start and end time for the interval.</p>
<p>With an interval start and end of 0 and 24 (and the last measurement time just after 24 hours):</p>
<ul>
<li>
<strong>AUC<sub>int</sub></strong> looks at the points in the interval, and if there is no measurement at the interval end time, interpolates or extrapolates to the interval end time (the AUClast and AUCint color in the figure)</li>
</ul>
</div>
<div id="auc-considerations-with-pknca-23-1" class="section level2 columns-2">
<h2 class="hasAnchor">
<a href="#auc-considerations-with-pknca-23-1" class="anchor"></a>AUC considerations with PKNCA (2/3)</h2>
<p><img src="Training-Session-1-of-2_files/figure-html/unnamed-chunk-25-1.png" width="100%"></p>
<p class="forceBreak">
</p>
<p>The considerations below mainly apply to actual-time data; nominal-time data usually have measurements at the start and end time for the interval.</p>
<p>With an interval start and end of 0 and 24 (and the last measurement time just after 24 hours):</p>
<ul>
<li>
<strong>AUC<sub>∞</sub></strong> is calculated based on AUC<sub>last</sub>, t<sub>last</sub>, and the half-life from t<sub>last</sub>, only using data within the interval– no data after the end of the interval.</li>
<li>Ensure that the interval used for calculating AUC<sub>∞</sub> includes all the points desired (usually, <code>end=Inf</code>).</li>
</ul>
</div>
</div>
<div id="hands-on-workshop" class="section level1">
<h1 class="hasAnchor">
<a href="#hands-on-workshop" class="anchor"></a>Hands-on workshop</h1>
<div id="steady-state-intramuscular-administration" class="section level2">
<h2 class="hasAnchor">
<a href="#steady-state-intramuscular-administration" class="anchor"></a>Steady-state intramuscular administration</h2>
<p>The data for the exercise are from a PK study of amikacin in a killer whale and a beluga whale. (DOI: 10.1638/03-078)</p>
<p><img src="https://apps-afsc.fisheries.noaa.gov/Quarterly/amj2005/images/killerwhales.jpg"></p>
<p>(Callback…)</p>
</div>
<div id="steady-state-intramuscular-administration-1" class="section level2">
<h2 class="hasAnchor">
<a href="#steady-state-intramuscular-administration-1" class="anchor"></a>Steady-state intramuscular administration</h2>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://billdenney.github.io/pknca/">PKNCA</a></span><span class="op">)</span>

<span class="va">d_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"c:/tmp/whale_conc.csv"</span><span class="op">)</span>
<span class="va">d_dose</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"c:/tmp/whale_dose.csv"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">d_conc</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">d_dose</span><span class="op">)</span>

<span class="va">o_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span><span class="va">concentration</span><span class="op">~</span><span class="va">time</span><span class="op">|</span><span class="va">Animal</span>, data<span class="op">=</span><span class="va">d_conc</span><span class="op">)</span>
<span class="va">o_dose</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdose.html">PKNCAdose</a></span><span class="op">(</span><span class="va">dose</span><span class="op">~</span><span class="va">time</span><span class="op">|</span><span class="va">Animal</span>, data<span class="op">=</span><span class="va">d_dose</span><span class="op">)</span>
<span class="va">o_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdata.html">PKNCAdata</a></span><span class="op">(</span><span class="va">o_conc</span>, <span class="va">o_dose</span><span class="op">)</span>
<span class="va">o_data</span><span class="op">$</span><span class="va">intervals</span>
<span class="va">o_nca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pk.nca.html">pk.nca</a></span><span class="op">(</span><span class="va">o_data</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">o_nca</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">o_nca</span>, drop.group<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">o_nca</span><span class="op">)</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Bill Denney, Clare Buckeridge.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
