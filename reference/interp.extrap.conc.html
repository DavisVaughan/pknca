<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Interpolate concentrations between measurements or extrapolate concentrations
after the last measurement. — interp.extrap.conc • PKNCA</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Interpolate concentrations between measurements or extrapolate concentrations
after the last measurement. — interp.extrap.conc" />
<meta property="og:description" content="interpolate.conc() and extrapolate.conc() returns an
interpolated (or extrapolated) concentration. interp.extrap.conc()
will choose whether interpolation or extrapolation is required and will also
operate on many concentrations.  These will typically be used to estimate the
concentration between two measured concentrations or after the last measured
concentration. Of note, these functions will not extrapolate prior to the
first point." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PKNCA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.4.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/AUC-Calculation-with-PKNCA.html">AUC Calculation with PKNCA</a>
    </li>
    <li>
      <a href="../articles/Example-theophylline.html">Computing NCA Parameters for Theophylline</a>
    </li>
    <li>
      <a href="../articles/Half-Life-Calculation.html">Half-Life Calculation</a>
    </li>
    <li>
      <a href="../articles/Introduction-and-Usage.html">Introduction to PKNCA and Usage Instructions</a>
    </li>
    <li>
      <a href="../articles/Methods-for-Dose-Aware-Interpolation-and-Extrapolation.html">Methods Used for Dose-Aware Concentration Interpolation/Extrapolation</a>
    </li>
    <li>
      <a href="../articles/Options-for-Controlling-PKNCA.html">Options for Controlling PKNCA</a>
    </li>
    <li>
      <a href="../articles/PKNCA-validation.html">PKNCA Validation</a>
    </li>
    <li>
      <a href="../articles/Post-Processing.html">Post-Processing</a>
    </li>
    <li>
      <a href="../articles/Selection-of-Calculation-Intervals.html">Selection of Calculation Intervals</a>
    </li>
    <li>
      <a href="../articles/Superposition.html">Superposition of Pharmacokinetic Data</a>
    </li>
    <li>
      <a href="../articles/Writing-Parameter-Functions.html">Writing PKNCA Parameter Functions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/billdenney/pknca/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Interpolate concentrations between measurements or extrapolate concentrations
after the last measurement.</h1>
    <small class="dont-index">Source: <a href='https://github.com/billdenney/pknca/blob/master/R/interpolate.conc.R'><code>R/interpolate.conc.R</code></a></small>
    <div class="hidden name"><code>interp.extrap.conc.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>interpolate.conc()</code> and <code>extrapolate.conc()</code> returns an
interpolated (or extrapolated) concentration. <code>interp.extrap.conc()</code>
will choose whether interpolation or extrapolation is required and will also
operate on many concentrations.  These will typically be used to estimate the
concentration between two measured concentrations or after the last measured
concentration. Of note, these functions will not extrapolate prior to the
first point.</p>
    </div>

    <pre class="usage"><span class='fu'>interp.extrap.conc</span><span class='op'>(</span>
  <span class='va'>conc</span>,
  <span class='va'>time</span>,
  <span class='va'>time.out</span>,
  lambda.z <span class='op'>=</span> <span class='cn'>NA</span>,
  clast <span class='op'>=</span> <span class='fu'><a href='pk.calc.clast.obs.html'>pk.calc.clast.obs</a></span><span class='op'>(</span><span class='va'>conc</span>, <span class='va'>time</span><span class='op'>)</span>,
  options <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  interp.method <span class='op'>=</span> <span class='cn'>NULL</span>,
  extrap.method <span class='op'>=</span> <span class='st'>"AUCinf"</span>,
  <span class='va'>...</span>,
  conc.blq <span class='op'>=</span> <span class='cn'>NULL</span>,
  conc.na <span class='op'>=</span> <span class='cn'>NULL</span>,
  check <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span>

<span class='fu'>interpolate.conc</span><span class='op'>(</span>
  <span class='va'>conc</span>,
  <span class='va'>time</span>,
  <span class='va'>time.out</span>,
  options <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  interp.method <span class='op'>=</span> <span class='cn'>NULL</span>,
  conc.blq <span class='op'>=</span> <span class='cn'>NULL</span>,
  conc.na <span class='op'>=</span> <span class='cn'>NULL</span>,
  conc.origin <span class='op'>=</span> <span class='fl'>0</span>,
  <span class='va'>...</span>,
  check <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span>

<span class='fu'>extrapolate.conc</span><span class='op'>(</span>
  <span class='va'>conc</span>,
  <span class='va'>time</span>,
  <span class='va'>time.out</span>,
  lambda.z <span class='op'>=</span> <span class='cn'>NA</span>,
  clast <span class='op'>=</span> <span class='fu'><a href='pk.calc.clast.obs.html'>pk.calc.clast.obs</a></span><span class='op'>(</span><span class='va'>conc</span>, <span class='va'>time</span><span class='op'>)</span>,
  extrap.method <span class='op'>=</span> <span class='st'>"AUCinf"</span>,
  options <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  conc.na <span class='op'>=</span> <span class='cn'>NULL</span>,
  conc.blq <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>,
  check <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span>

<span class='fu'>interp.extrap.conc.dose</span><span class='op'>(</span>
  <span class='va'>conc</span>,
  <span class='va'>time</span>,
  <span class='va'>time.dose</span>,
  route.dose <span class='op'>=</span> <span class='st'>"extravascular"</span>,
  duration.dose <span class='op'>=</span> <span class='cn'>NA</span>,
  <span class='va'>time.out</span>,
  out.after <span class='op'>=</span> <span class='cn'>FALSE</span>,
  options <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  conc.blq <span class='op'>=</span> <span class='cn'>NULL</span>,
  conc.na <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>,
  check <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>conc</th>
      <td><p>Measured concentrations</p></td>
    </tr>
    <tr>
      <th>time</th>
      <td><p>Time of the concentration measurement</p></td>
    </tr>
    <tr>
      <th>time.out</th>
      <td><p>Time when interpolation is requested (vector for
<code>interp.extrap.conc()</code>, scalar otherwise)</p></td>
    </tr>
    <tr>
      <th>lambda.z</th>
      <td><p>The elimination rate constant.  <code>NA</code> will prevent
extrapolation.</p></td>
    </tr>
    <tr>
      <th>clast</th>
      <td><p>The last observed concentration above the limit of
quantification.  If not given, <code>clast</code> is calculated from
<code><a href='pk.calc.clast.obs.html'>pk.calc.clast.obs</a>()</code></p></td>
    </tr>
    <tr>
      <th>options</th>
      <td><p>List of changes to the default <code><a href='PKNCA.options.html'>PKNCA.options</a>()</code>
for calculations.</p></td>
    </tr>
    <tr>
      <th>interp.method</th>
      <td><p>The method for interpolation (either "lin up/log down"
or "linear")</p></td>
    </tr>
    <tr>
      <th>extrap.method</th>
      <td><p>The method for extrapolation: "AUCinf", "AUClast", or
"AUCall".  See details for usage.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments passed to <code>interpolate.conc()</code> or
<code>extrapolate.conc()</code>.</p></td>
    </tr>
    <tr>
      <th>conc.blq</th>
      <td><p>How to handle BLQ values. (See <code><a href='clean.conc.blq.html'>clean.conc.blq</a>()</code>
for usage instructions.)</p></td>
    </tr>
    <tr>
      <th>conc.na</th>
      <td><p>How to handle NA concentrations.  (See
<code><a href='clean.conc.na.html'>clean.conc.na</a>()</code>)</p></td>
    </tr>
    <tr>
      <th>check</th>
      <td><p>Run <code><a href='check.conc.time.html'>check.conc.time</a>()</code>,
<code><a href='clean.conc.blq.html'>clean.conc.blq</a>()</code>, and <code><a href='clean.conc.na.html'>clean.conc.na</a>()</code>?</p></td>
    </tr>
    <tr>
      <th>conc.origin</th>
      <td><p>The concentration before the first measurement.
<code>conc.origin</code> is typically used to set predose values to zero
(default), set a predose concentration for endogenous compounds, or set
predose concentrations to <code>NA</code> if otherwise unknown.</p></td>
    </tr>
    <tr>
      <th>time.dose</th>
      <td><p>Time of the dose</p></td>
    </tr>
    <tr>
      <th>route.dose</th>
      <td><p>What is the route of administration ("intravascular" or
"extravascular").  See the details for how this parameter is used.</p></td>
    </tr>
    <tr>
      <th>duration.dose</th>
      <td><p>What is the duration of administration? See the details
for how this parameter is used.</p></td>
    </tr>
    <tr>
      <th>out.after</th>
      <td><p>Should interpolation occur from the data before
(<code>FALSE</code>) or after (<code>TRUE</code>) the interpolated point?  See the
details for how this parameter is used.  It only has a meaningful effect at
the instant of an IV bolus dose.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The interpolated or extrapolated concentration value as a scalar
  double (or vector for <code>interp.extrap.conc()</code>).</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    
<dl>
  <dt>extrap.method</dt><dd><p><dl>
      <dt>'AUCinf'</dt><dd><p>Use lambda.z to extrapolate beyond the last point with the half-life.</p></dd>
      <dt>'AUCall'</dt><dd><p>If the last point is above the limit of quantification or missing, this is identical to 'AUCinf'. If the last point is below the limit of quantification, then linear interpolation between the Clast and the next BLQ is used for that  interval and all additional points are extrapolated as 0.</p></dd>
      <dt>'AUClast'</dt><dd><p>Extrapolates all points after the last above the  limit of quantification as 0.</p></dd></dl></p></dd>

</dl>

<p><code>duration.dose</code> and <code>direction.out</code> are ignored if <code>route.dose
== "extravascular"</code>.  <code>direction.out</code> is ignored if <code>duration.dose
&gt; 0</code>.</p>
<p><code>route.dose</code> and <code>duration.dose</code> affect how
interpolation/extrapolation of the concentration occurs at the time of
dosing.  If <code>route.dose == "intravascular"</code> and <code>duration.dose ==
0</code> then extrapolation occurs for an IV bolus using <code><a href='pk.calc.c0.html'>pk.calc.c0</a>()</code>
with the data after dosing.  Otherwise (either <code>route.dose ==
"extravascular"</code> or <code>duration.dose &gt; 0</code>), extrapolation occurs using the
concentrations before dosing and estimating the half-life (or more precisely,
estimating <code>lambda.z</code>).  Finally, <code>direction.out</code> can change the
direction of interpolation in cases with <code>route.dose == "intravascular"</code>
and <code>duration.dose == 0</code>.  When <code>direction.out == "before"</code>
interpolation occurs only with data before the dose (as is the case for
<code>route.dose == "extravascular"</code>), but if <code>direction.out == "after"</code>
interpolation occurs from the data after dosing.</p>
    <h2 class="hasAnchor" id="functions"><a class="anchor" href="#functions"></a>Functions</h2>

    
<ul>
<li><p><code>interpolate.conc</code>: Interpolate concentrations through Tlast (inclusive)</p></li>
<li><p><code>extrapolate.conc</code>: Extrapolate concentrations after Tlast</p></li>
<li><p><code>interp.extrap.conc.dose</code>: Interpolate and extrapolate 
concentrations without interpolating or extrapolating beyond doses.</p></li>
</ul>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='pk.calc.clast.obs.html'>pk.calc.clast.obs</a>()</code>,
  <code><a href='pk.calc.half.life.html'>pk.calc.half.life</a>()</code>, <code><a href='pk.calc.c0.html'>pk.calc.c0</a>()</code></p></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Bill Denney, Clare Buckeridge.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


